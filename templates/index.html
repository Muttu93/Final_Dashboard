<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/script.js"></script>
</head>
<body>
    <h1>Document Dashboard</h1>
    <div class="sidebar">
        {% for sec in sections %}
            <a href="/?section={{sec}}" class="{{ 'active' if sec==section else '' }}">{{sec}}</a>
        {% endfor %}
    </div>

    <div class="content">
        <form method="GET" action="/">
            <input type="hidden" name="section" value="{{section}}">
            <input type="text" name="query" placeholder="Search files..." value="{{query}}">
            <button type="submit">Search</button>
        </form>

        <h2>{{section}} Files</h2>
        <form action="/upload" method="POST" enctype="multipart/form-data">
            <input type="hidden" name="section" value="{{section}}">
            <input type="file" name="file" required>
            <button type="submit">Upload</button>
        </form>

        {% with messages = get_flashed_messages() %}
          {% if messages %}
            {% for message in messages %}
              <p class="flash">{{ message }}</p>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <table>
            <tr><th>Filename</th><th>Modified Time</th><th>Actions</th></tr>
            {% for file in files %}
            <tr>
                <td>{{file.name}}</td>
                <td>{{file.mtime}}</td>
                <td>
                    <a href="/view/{{section}}/{{file.name}}" target="_blank">View</a> |
                    <a href="/edit/{{section}}/{{file.name}}">Edit</a> |
                    <form action="/delete/{{section}}/{{file.name}}" method="POST" style="display:inline;" onsubmit="return confirmDelete();">
                        <button type="submit">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
</body>
</html>
